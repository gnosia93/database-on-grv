
aws ec2 describe-subnets


```
VPC_ID=$(aws ec2 describe-vpcs --filters Name=tag:Name,Values=grav-vpc --query 'Vpcs[].VpcId' --output text)
VPC_SUBNETS=$(aws ec2 describe-subnets --filter Name=tag:aws-cdk:subnet-type,Values=Isolated --query "Subnets[?VpcId=='$VPC_ID'].SubnetId" | tr -d '\n\r ')

cat <<_EOF > broker-grp-info.json
{
    "InstanceType": "kafka.m5.xlarge",
    "BrokerAZDistribution": "DEFAULT",
    "ClientSubnets": <VPC_SUBNETS>
}
_EOF

sed -i -e "s/<VPC_SUBNETS>/${VPC_SUBNETS}/" broker-grp-info.json

```

```
aws kafka create-cluster \
--cluster-name msk-grav \
--kafka-version "3.6.0" \
--number-of-broker-nodes 3 \
--broker-node-group-info file://broker-grp-info.json \
--region ap-northeast-2
```

[broker-grp-info.json]
```
{
    "InstanceType": "kafka.m5.xlarge",
    "BrokerAZDistribution": "DEFAULT",
    "ClientSubnets": [
        "subnet-0123456789111abcd",
        "subnet-0123456789222abcd",
        "subnet-0123456789333abcd"
    ]
}
```





## 레퍼런스 ##

* https://docs.aws.amazon.com/ko_kr/cli/latest/reference/kafka/create-cluster.html
